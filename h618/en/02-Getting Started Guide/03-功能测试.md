# 03-Function Testing



## Instructions

Unless otherwise specified, the testing methods are applicable to both Ubuntu and Android systems.



## Ethernet

Connect the board's network port to a network cable.

**K2B: 100M/1000M network port**

![image-20250427144337458](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250427144337458.png)

The left network port light being on indicates a 100M connection, and the right one being on indicates a 1000M connection.

**K2C: 100M network port**

K2C has no network port lights.

You can view the board's IP address through the router background or the serial port terminal.
![image-20250412164019949](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250412164019949.png)



**User-layer LED Status Control**

The default LED trigger mode is "heartbeat", in which the LED status cannot be manually controlled. To enable command-based LED status control, use the following commands to set the trigger mode to "none" and then adjust the brightness:

```shell
echo none > /sys/class/leds/sys_led/trigger
echo 1 > /sys/class/leds/sys_led/brightness
echo 0 > /sys/class/leds/sys_led/brightness
```

## IR Infrared

**Android**

Use a remote control to operate the main interface.

**Ubuntu**

``` shell
cat /proc/bus/input/devices
hexdump /dev/input/event0
Press the remote control and check for event reports.
```

![image-20250412151436282](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250412151436282.png)

## HDMI

**Android System**

Connect the motherboard to an HDMI-1080P monitor. After the system starts successfully, the interface is as follows:

![image-20240306171855522](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20240306171855522.png)

**Ubuntu System**

Connect the board to an HDMI-1080P monitor. The system display is as follows when booting:

![image-20250412150306655](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250412150306655.png)



## Audio

**Android**

Headphone audio output is disabled by default. Enable analog audio output in Android 12.0 system settings:

![image-20250428151212987](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250428151212987.png)

![image-20250428151241109](C:\Users\10539\AppData\Roaming\Typora\typora-user-images\image-20250428151241109.png)

![image-20250428151317031](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250428151317031.png)

![image-20250428151339351](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250428151339351.png)

![image-20250428151524271](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250428151524271.png)

**Ubuntu**

Desktop Playback

Requires an HDMI screen with built-in speakers.

``` shell
cd /bin
sudo ln -s pavucontrol pavucontrol-qt
sudo apt-get update
sudo apt purge pulseaudio
sudo apt install pulseaudio
reboot
```

Select the second option for HDMI output and the first for headphone output in the volume control menu at the top right corner.

![image-20250427194148974](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250427194148974.png)

Command-line Playback

``` shell
$ aplay <filepath> 		 # Play audio, use -h for help
$ amixer 				 # Alsa tool for audio configuration, use -h for help
$ cat /proc/asound/cards  # List sound cards
```

K2B

``` shell
HDMI output:
aplay -D hw:0,0 music.wav
```

``` shell
Headphone output:
aplay -D hw:1,0 music.wav
```

K2C

``` shell
HDMI output:
aplay -D hw:2,0 music.wav
```

``` shell
Headphone/speaker output:
aplay -D hw:1,0 music.wav
```



## WiFi / Bluetooth

**Android**

![image-20250428161839792](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250428161839792.png)

**Ubuntu**

WiFi

```shell
# View network device list
sudo nmcli dev

# Enable WiFi
sudo nmcli r wifi on

# Disable WiFi
sudo nmcli r wifi off

# Scan nearby hotspots
sudo nmcli dev wifi

# Connect to a hotspot (replace SSID and PASSWORD)
sudo nmcli dev wifi connect "SSID" password "PASSWORD" ifname wlan0
```



**Bluetooth**

1.Install Bluetooth Tools

```shell
$ sudo apt-get update
$ sudo apt-get install bluez
```

2.Check Bluetooth Devices

```shell
$ hciconfig -a  
```

3.Classic Bluetooth Operations

```shell
经典蓝牙扫描
bluetoothctl scan on
配对
bluetoothctl pair 28:52:E0:19:17:69
连接
bluetoothctl connect 28:52:E0:19:17:69
信任此设备，下次可直接连接 无需配对
bluetoothctl trust 28:52:E0:19:17:69
断开
bluetoothctl disconnect 28:52:E0:19:17:69
解除配对
bluetoothctl remove FC:E8:06:E7:96:AF   
阻止连接
bluetoothctl block  FC:E8:06:E7:96:AF 
查看配好对的蓝牙设备
bluetoothctl paired-devices
```

设置蓝牙设备播放音频

``` shell
查看连接的蓝牙设备
bluetoothctl paired-devices 
设置蓝牙播放
pacmd set-default-sink bluez_sink.28_52_E0_19_17_69.a2dp_sink
播放音频
aplay sample-15s.wav
```

![image-20250428144858777](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250428144858777.png)

``` shell
低功耗BLE蓝牙扫描
$ hcitool -i hci0 cmd 0x03 0x0003
$ hcitool -i hci0 cmd 08 01 3f 00 00 00 00 00 00 00
$ hcitool lescan
```



## USB

USB口接入U盘

``` shell
lsblk
```

![image-20250412150828553](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250412150828553.png)

挂载

``` shell
 mkdir /mnt/sda
 mount /dev/sda1 /mnt/sda/
 ls /mnt/sda/
```

## 4G

**Ubuntu**

> 板卡：K2C

1.确认usb模块是否加载

```shell
# lsusb
```

2.确认串口结点是否生成

```shell
# ls /dev/ttyUSB*
```

3.插拔电话卡重新拨号

```shell
# sudo pppd call quectel-ppp &
```

可能会出现没播通情况
通过`ps -ef | grep pppd` 查看进程号
`kill -9 (进程号)` 结束进程
然后重新拨号

4.外网ping测试

```shell
# ping www.baidu.com
```

ping外网可能出现DNS解析失败，需要添加对应DNS

修改resolv.conf文件

```shell
# vim /etc/resolv.conf
```

可以添加下面内容:

```shell
nameserver 8.8.8.8
nameserver 8.8.4.4
```



**Android**

安卓TV系统不支持4G



## KEY

**Android**

按下USER按键为休眠唤醒

长按为关机，无法长按开机

**Ubuntu**

按下USER按键打开Log out界面

![image-20250512100543793](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250512100543793.png)

## RS485/232

> 板卡：K2C

KICKPI-K2C设计中可选配：一路485（/dev/ttyAS3）一路232(/dev/ttyAS4)

板卡背后有丝印标记

![image-20250428162920707](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250428162920707.png)

设置波特率

```shell
stty -F /dev/ttyAS3 115200
```

发送数据

``` shell
echo "123" > /dev/ttyAS3
```

接收数据

``` shell
cat /dev/ttyAS3
```



## 常见问题

有线网口使用局域网，WiFi连接网络时无法访问外网

![image-20250427165431777](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20250427165431777.png)

[解决Linux下同时使用有线和无线网络时，网络连接的优先级问题_linux以太网和无线网冲突问题-CSDN博客](https://blog.csdn.net/qq547276542/article/details/78713893)

