# 12-硬件功能使用说明


<link rel="stylesheet" type="text/css" href="auto-number-title.css" />


## 扩展引脚 <a name="扩展引脚"></a>

开发板配备20Pin扩展引脚，其中包含普通GPIO、I2C、UART、SPI等接口。

![image-20240319154848492](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20240319154848492.png)

## LED

开发板配备两个LED灯，默认状态下，绿色LED为电源指示灯，蓝色LED为心跳指示灯

电源指示灯上电即长亮，心跳灯内核启动后持续闪烁。另外，可参考以下方面控制LED作为其他功能。

通过两个LED灯的状态，可初步判断开发板运行的状态。

若电源指示灯不亮则检查电源部分异常，若心跳指示灯不闪烁则系统运行异常。


### 用户层控制LED状态

默认LED触发方式为heartbeat，此方式下LED状态不可人为控制。

若想要实现命令控制LED状态的话，可通过以下命令设置为none，然后再设置LED的brightness

```
$ echo none > /sys/class/leds/work-led/trigger
$ echo 1 > /sys/class/leds/work-led/brightness
$ echo 0 > /sys/class/leds/work-led/brightness
```

## GPIO

K2B开发板的扩展20Pin引脚中默认有9路可控GPIO。

首先，通过 [扩展引脚](#扩展引脚) 章节，确认GPIO引脚位置、编号，参考以下步骤可对指定GPIO进行状态控制。



**查看GPIO注册列表**

```
$ ls /sys/class/leds/
	PC7  PC12  PI6  sys_led
```



**命令行控制GPIO电平**

```
$ echo 1 > /sys/class/leds/sys_led/brightness
$ echo 0 > /sys/class/leds/sys_led/brightness
```



**读取GPIO电平**

```
$ cat /sys/class/leds/sys_led/brightness
```

> 0为低电平
>
> 255为高电平



## 调试串口

**开发板调试串口接线**

调试串口内嵌到扩展引脚上，可通过 [扩展引脚](#扩展引脚) 章节 或下图查看调试串口位置

![image-20240319154747393](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20240319154747393.png)



**下载串口助手软件**

串口助手软件 可自行下载，下面以Mobaxterm为例

Mobaxterm软件地址下载：https://mobaxterm.mobatek.net/



**Mobaxterm操作步骤**

1. 新建会话窗口

2. 选择会话窗口类型为serial

3. 选择串口COM编号（打开Windows系统 设备管理器 -> 端口界面可查看COM编号）

4. 选择串口波特率115200

5. 启动会话窗口

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20240319182217644.png)


## 普通串口

**注册结点后**
```
$ ls dev/tty*
```

## WIFI / BlueTooth

K2B开发板 配备AW859A高性能WIFI模块

支持2.4G/5G双频段，WIFI5，1T1R，BT5.0


## KEY

K2B配备3个按键，分别是RECOVERY KEY、RST KEY、MASKROM KEY

RECOVERY按键在UBOOT阶段可用于进入烧录模式，进入系统后作为用户自定义功能按键


### 自定义按键功能

```
        gpio-keys {
                compatible = "gpio-keys";
                status = "okay";
                autorepeat;

                power {
                        label = "Power Key";
                        linux,code = <KEY_POWER>;
                        gpio = <&pio PC 2 GPIO_ACTIVE_LOW>;     /* PC7 */
                        wakeup-source;
                        debounce-interval = <100>;
                };
        };
```





## RTC

**硬件接线**

测试 RTC 功能必须外接纽扣电池，并且确认电池电量充足

### 掉电保存时间测试

测试步骤：

1 开发板连接网络，自动同步正确网络时间

2 断开网络连接，并且断开开发板供电电源

3 等待若干时间后，重新接上开发板电源

4 若系统时间与当前时间一致，则RTC功能正常

## LCD

K5开发板支持LVDS和MIPI接口

### MIPI
**硬件接线**

Single LVDS 和 MIPI 复用同一端口

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

### Single LVDS
**硬件接线**

Single LVDS 和 MIPI 复用同一端口

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

### DUAL LVDS

DUAL LVDS供电电压可选3.3V、5V、12V，必须根据规格书选择对应电压，否则会不能点亮或烧屏

**硬件接线**

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

## MIPI CAMERA

K5开发板支持双路MIPI CSI 4Lane 摄像头接口，最多可接四路摄像头

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

## ADC

A133 配备X路ADC，K5开发板引出ADC3通道到扩展引脚座

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

## FAN
**硬件接线**

风扇供电电压为5V，连接方式如下图所示

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

## 4G通讯模块
**硬件接线**

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

## 喇叭
**硬件接线**

![image-20240319182217644](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image.png)

## 耳机
**硬件接线**


