# 14-硬件老化测试

硬件工厂测试 是基于DeviceTest 应用程序 的硬件老化测试

主要针对CPU、DDR、GPU、VPU老化测试





## 拷贝VPU测试视频

VPU老化测试项 需要拷贝 视频文件 到 系统 或SD卡的指定目录，老化程序会对视频进入解码测试



**视频文件要求**：

视频文件名称 和 视频文件路径 必须跟以下一致

```
/sdcard/Aging_Test_Video.mp4
```



下面说明 拷贝视频的两个常见方法

1. 通过adb push 工具推送 Aging_Test_Video.mp4 视频文件到/sdcard目录
2. 拷贝视频文件到 U盘 或 SD卡，通过文件管理器 拷贝到/sdcard目录



## 进入硬件老化程序

步骤：

1. 打开系统应用列表中的 计算器
2. 计算器输入 "000.=" 字符
3. 选择 "DeviceTest" ，并且点击Just once 或 Always
4. 硬件测试程序启动界面



![image-20231021114933026](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20231021114933026.png)





![image-20231021142650040](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20231021142650040.png)





![image-20231021140838546](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20231021140838546.png)



![image-20231021140920296](http://tanzhtanzh.oss-cn-shenzhen.aliyuncs.com/img/image-20231021140920296.png)



## DEBIAN 11 本地解码1080P和4K帧率性能：

#### 测试方法：

​	1.拷贝1080P及4K的视频到板子，通过chrome浏览器本地解码。

​	2.查看GPU占用：

```
cat /sys/devices/platform/*gpu/utilisation   //显示结果单位为%
```

​	3.打开帧解码log并打印：

```
export mpi_debug=1
export mpp_debug=1
export h264d_debug=1
export mpp_syslog_perror=1
echo 0x100 > /sys/module/rk_vcodec/parameters/mpp_dev_debug
```

#### 测试结果：

​	1080P_30帧/秒：GPU占用在42%-48%左右，

​	每帧解码时间测试结果log：

```
[  639.172225] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 4195 us hw 4095 us
[  639.180185] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 12116 us hw 7960 us
[  639.190246] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 19541 us hw 10027 us
[  639.199403] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 22900 us hw 9153 us
[  639.203403] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 20805 us hw 4053 us
[  639.213146] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 21496 us hw 9638 us
[  639.222129] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 21700 us hw 9056 us
[  639.228897] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 24810 us hw 6819 us
[  639.403439] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 6511 us hw 6482 us
[  639.411955] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 11883 us hw 8450 us
[  639.420139] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 17932 us hw 8009 us
[  639.429258] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 24691 us hw 9296 us
[  639.503067] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 5224 us hw 5164 us
[  639.509281] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 8586 us hw 6174 us
[  639.518009] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 14440 us hw 8704 us
[  639.529122] rk_vcodec: fdf80200.rkvdec:0 session 2268:56 time: 22595 us hw 11125 us
```

​	4K_30帧/秒：GPU占用在60%-68%左右，

​	每帧解码时间测试结果log：



